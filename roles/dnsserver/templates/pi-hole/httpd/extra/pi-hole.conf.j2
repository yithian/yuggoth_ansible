{{ ansible_managed | comment }}
# configuration for pi-hole
<VirtualHost *:{{ web_port }}>
    ServerAdmin {{ user }}@{{ domain }}
    ServerName pi.hole

    Redirect permanent / https://pi.hole/

    ErrorLog /var/log/httpd/pi.hole-error_log
    CustomLog /var/log/httpd/pi.hole-access_log common
</VirtualHost>

<VirtualHost *:{{ ssl_port }}>
    ServerAdmin {{ user }}@{{ domain }}
    ServerName pi.hole

    ProxyPass / http://localhost:{{ pihole_port }}/
    ProxyPassReverse / http://localhost:{{ pihole_port }}/

    SSLEngine on
    SSLCertificateFile "/etc/letsencrypt/live/{{ web_host }}/fullchain.pem"
    SSLCertificateKeyFile "/etc/letsencrypt/live/{{ web_host }}/privkey.pem"

    BrowserMatch "MSIE [2-5]" \
         nokeepalive ssl-unclean-shutdown \
         downgrade-1.0 force-response-1.0
    ErrorLog /var/log/httpd/ssl_pi.hole-error_log
    CustomLog "/var/log/httpd/ssl_pi.hole-request_log" \
          "%t %h %{SSL_PROTOCOL}x %{SSL_CIPHER}x \"%r\" %b"
</VirtualHost>
