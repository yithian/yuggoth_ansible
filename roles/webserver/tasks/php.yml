---
- name: install php (and other requirements)
  pacman:
      name: "{{ item }}"
      state: installed
  with_items:
      - php
      - php-apache
      - php-apcu-bc # optional by nextcloud
      - php-gd # required by nextcloud
      - php-intl # recommended by nextcloud
      - php-mcrypt # recommended by nextcloud and roundcube
      - php-pspell # optional by roundcube
      - pear-auth-sasl # required by roundcube
      - pear-mail-mime # required by roundcube
      - pear-net-idna2 # required by roundcube
      - pear-net-sieve # optional for roundcube
      - pear-net-smtp # required by roundcube
      - pear-net-socket # required by roundcube
  notify: restart httpd
  tags:
      - php
      - nextcloud
      - roundcube
      - wordpress

- name: configure php
  copy:
      src: files/php/php.ini
      dest: /etc/php/php.ini
      owner: root
      group: root
      mode: 0644
  notify: restart httpd
  tags:
      - php
      - nextcloud
      - roundcube
      - wordpress

- name: configure apcu
  copy:
      src: files/php/conf.d/apcu.ini
      dest: /etc/php/conf.d/apcu.ini
      owner: root
      group: root
      mode: 0644
  notify: restart httpd
  tags:
      - php
      - nextcloud
      - roundcube
